System.register(["jimu-core/emotion","jimu-core","jimu-core/react"],function(e,l){var r={},a={},o={};return{setters:[function(e){r.jsx=e.jsx,r.jsxs=e.jsxs},function(e){a.React=e.React},function(e){o.useEffect=e.useEffect,o.useState=e.useState}],execute:function(){e((()=>{var e={244(e){"use strict";e.exports=a},386(e){"use strict";e.exports=r},972(e){"use strict";e.exports=o}},l={};function t(r){var a=l[r];if(void 0!==a)return a.exports;var o=l[r]={exports:{}};return e[r](o,o.exports,t),o.exports}t.d=(e,l)=>{for(var r in l)t.o(l,r)&&!t.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:l[r]})},t.o=(e,l)=>Object.prototype.hasOwnProperty.call(e,l),t.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.p="";var n={};return t.p=window.jimuConfig.baseUrl,(()=>{"use strict";t.r(n),t.d(n,{__set_webpack_public_path__:()=>S,default:()=>w});var e=t(386),l=t(244),r=t(972),a=function(e,l,r,a){return new(r||(r=Promise))(function(o,t){function n(e){try{u(a.next(e))}catch(e){t(e)}}function i(e){try{u(a.throw(e))}catch(e){t(e)}}function u(e){var l;e.done?o(e.value):(l=e.value,l instanceof r?l:new r(function(e){e(l)})).then(n,i)}u((a=a.apply(e,l||[])).next())})};const{Fragment:o}=l.React,i="https://services2.arcgis.com/vH5RykSdaAwiEGOJ/arcgis/rest/services/GII_uteniti/FeatureServer/0";function u(e){return new Promise((l,r)=>{const a=window.require;if(a)try{a([e],e=>l(e),e=>r(e))}catch(e){r(e)}else r(new Error("AMD require non disponibile"))})}const s={GII_AGR_D1_TR:"5f7a1c6083024ed6912642dea33df836",GII_AGR_D1_TI:"d2538065685a4e278418d9d4ee63b4f5",GII_AGR_D1_RZ:"77e930cf78684ec28554cb47e09de22c",GII_AGR_D2_TR:"be5397892089463f9de53c39bfe867d5",GII_AGR_D2_TI:"b69f51f2b4dc48e5bcd945a0e006a521",GII_AGR_D2_RZ:"80a5260795cf43cca065815fe6e868ab",GII_AGR_D3_TR:"e8b70407a2cd4f79936d95e4ee2d66d8",GII_AGR_D3_TI:"d9df51a9ad09458cb7d6677101f8a64c",GII_AGR_D3_RZ:"6bc744628d2742e082d319d302cae2ef",GII_AGR_D4_TR:"98a0edc68f1e4eb3ac06991862407082",GII_AGR_D4_TI:"56a0e66617cc4bbb9415e520f503ad32",GII_AGR_D4_RZ:"40c17e737f5d40cbbdfe0fe28f702446",GII_AGR_D5_TR:"d0b21d5c77d54f71a951162c102337bf",GII_AGR_D5_TI:"8c201a0905ff4cb7999f375d21962acb",GII_AGR_D5_RZ:"29c74c75fe724258809b2bcaf27d7e21",GII_AGR_D6_TR:"d4f997fcc65140b585f9784f36b82efb",GII_AGR_D6_TI:"f82bc26c62cf49328fc101f83121d1a7",GII_AGR_D6_RZ:"62e5ca9cb9e04de7b446cf97d287b815",GII_AGR_DIR:"efd1d706a54249c785fc2d85fa8a672b",GII_AGR_RI:"4eb266a8da414fe6a47bc16f66c58e6a",GII_AMM_DIR:"317c399ad1984c4392a6341d129fda89",GII_AMM_RI:"73ab7007181c447a89ba5a91f417acb0",GII_AMM_TI:"51d72060aa0540ab9b707fadb2dcca50",GII_TEC_DIR:"720b7ca166d5465e884ea3ad684029b8",GII_TEC_DS_RZ:"7ff515bb66894ee79ce70a9b8f248b94",GII_TEC_DS_TI:"f204e16c17ff47a3984bedd5b6d4a6d9",GII_TEC_DS_TR:"ca0fd1f481014871bee270a89bf53bcb",GII_TEC_RI:"e0cde3526baf4215811c211c7fda43fb"},d="https://cbsm-hub.maps.arcgis.com",c="1t9qSylui7Nt4Hca";function g(e){return a(this,void 0,void 0,function*(){var l,r;try{const a=(yield u("esri/identity/IdentityManager")).credentials;if(null==a?void 0:a.length){const e=null!==(l=a.find(e=>e.server&&e.server.includes("cbsm-hub.maps.arcgis.com")))&&void 0!==l?l:a[0];if(null==e?void 0:e.token)return e.token}const o=new URLSearchParams({client_id:c,client_secret:e,grant_type:"client_credentials",f:"json"}),t=yield fetch(`${d}/sharing/rest/oauth2/token`,{method:"POST",body:o});return null!==(r=(yield t.json()).access_token)&&void 0!==r?r:""}catch(e){return console.error("getAGOLToken error:",e),""}})}function f(e,l,r){return a(this,void 0,void 0,function*(){var a;const o=s[l];if(!o)return;const t=new URLSearchParams({users:e,f:"json",token:r}),n=yield fetch(`${d}/sharing/rest/community/groups/${o}/addUsers`,{method:"POST",body:t}),i=yield n.json();if(null===(a=i.errors)||void 0===a?void 0:a.length)throw new Error(`addUsers: ${i.errors[0].message}`)})}function b(e,l,r){return a(this,void 0,void 0,function*(){var a;const o=s[l];if(!o)return;const t=new URLSearchParams({users:e,f:"json",token:r}),n=yield fetch(`${d}/sharing/rest/community/groups/${o}/removeUsers`,{method:"POST",body:t}),i=yield n.json();if(null===(a=i.errors)||void 0===a?void 0:a.length)throw new Error(`removeUsers: ${i.errors[0].message}`)})}const p=[{label:"TR",value:1},{label:"TI",value:2},{label:"RZ",value:3},{label:"RI",value:4},{label:"DT",value:5},{label:"DA",value:6}],v=[{label:"AMM",value:1},{label:"AGR",value:2},{label:"TEC",value:3}],m=[{label:"CR",value:1},{label:"GI",value:2},{label:"D1",value:3},{label:"D2",value:4},{label:"D3",value:5},{label:"D4",value:6},{label:"D5",value:7},{label:"D6",value:8},{label:"DS",value:9}],h=[{label:"Cagliari",value:1,aree:[1,2],settori:[1,2]},{label:"Quartucciu (loc. Is Forreddus)",value:2,aree:[2],settori:[3]},{label:"Muravera",value:3,aree:[2],settori:[3]},{label:"Villaputzu",value:4,aree:[2],settori:[3]},{label:"San Sperate",value:5,aree:[2],settori:[3]},{label:"Serramanna (loc. Pimpisu)",value:6,aree:[2],settori:[4]},{label:"San Gavino Monreale",value:7,aree:[2],settori:[5]},{label:"Villacidro",value:8,aree:[2],settori:[5]},{label:"San Giovanni Suergiu (loc. Sa Carabia)",value:9,aree:[2],settori:[6]},{label:"Masainas",value:10,aree:[2],settori:[6]},{label:"Senorb\xec",value:11,aree:[2],settori:[7]},{label:"Iglesias (loc. Sa Stoia)",value:12,aree:[2],settori:[8]},{label:"Siliqua",value:13,aree:[2],settori:[8]},{label:"Cagliari (TEC)",value:14,aree:[3],settori:[9]},{label:"Villasor",value:15,aree:[3],settori:[9]},{label:"San Giovanni Suergiu (loc. Is Samis)",value:16,aree:[3],settori:[9]}];function x(e){switch(e){case 1:case 3:case 5:return[2,3];case 2:case 4:return[1,2,3];case 6:return[1];default:return[]}}function _(e,l){return 5===e||6===e?[]:4===e?1===l?[1]:2===l?[2]:3===l?[9]:[]:2===e&&1===l?[1]:2===l?[3,4,5,6,7,8]:3===l?[9]:[]}function j(e,l){return h.filter(r=>r.aree.includes(e)&&r.settori.includes(l))}function I(e,l,r){var a,o,t,n,i,u;const s=null!==(o=null===(a=p.find(l=>l.value===e))||void 0===a?void 0:a.label)&&void 0!==o?o:"",d=null!==(n=null===(t=v.find(e=>e.value===l))||void 0===t?void 0:t.label)&&void 0!==n?n:"",c=null!==(u=null===(i=m.find(e=>e.value===r))||void 0===i?void 0:i.label)&&void 0!==u?u:"";if("AGR"===d){if(["TR","TI","RZ"].includes(s))return`GII_AGR_${c}_${s}`;if("RI"===s)return"GII_AGR_RI";if("DT"===s)return"GII_AGR_DIR"}if("TEC"===d){if(["TR","TI","RZ"].includes(s))return`GII_TEC_${c}_${s}`;if("RI"===s)return"GII_TEC_RI";if("DT"===s)return"GII_TEC_DIR"}if("AMM"===d){if("DA"===s)return"GII_AMM_DIR";if("TI"===s)return"GII_AMM_TI";if("RI"===s)return"GII_AMM_RI"}return""}const y=()=>({username:"",full_name:"",ruolo:null,area:null,settore:null,ufficio:null,gruppo:"",gruppo_precedente:""});let R=null;function G(){return a(this,void 0,void 0,function*(){if(R)return R;const e=yield u("esri/layers/FeatureLayer");return R=new e({url:i}),yield R.load().catch(()=>{}),R})}const N="\n  .ggu { font-family: Arial, sans-serif; font-size: 13px; padding: 12px; height: 100%; display: flex; flex-direction: column; gap: 10px; box-sizing: border-box; }\n  .ggu-title { font-size: 15px; font-weight: bold; color: #1F4E79; border-bottom: 2px solid #1F4E79; padding-bottom: 6px; margin: 0; }\n  .ggu-form { background: #f5f9ff; border: 1px solid #c5d9f1; border-radius: 6px; padding: 14px; display: grid; grid-template-columns: 1fr 1fr; gap: 10px; }\n  .ggu-field { display: flex; flex-direction: column; gap: 3px; }\n  .ggu-label { font-size: 11px; font-weight: bold; color: #1F4E79; }\n  .ggu-input, .ggu-select { width: 100%; padding: 5px 8px; border: 1px solid #aac4e0; border-radius: 4px; font-size: 13px; box-sizing: border-box; background: #fff; }\n  .ggu-input:focus, .ggu-select:focus { outline: none; border-color: #1F4E79; }\n  .ggu-input:disabled, .ggu-select:disabled { background: #e8f0e9; color: #375623; font-style: italic; border-color: #b8d4b0; }\n  .ggu-btns { display: flex; gap: 8px; grid-column: 1 / -1; padding-top: 4px; }\n  .ggu-btn { padding: 6px 18px; border: none; border-radius: 4px; font-size: 13px; cursor: pointer; font-weight: bold; }\n  .ggu-btn:disabled { opacity: 0.6; cursor: not-allowed; }\n  .ggu-btn-save { background: #1F4E79; color: #fff; }\n  .ggu-btn-save:hover:not(:disabled) { background: #16375a; }\n  .ggu-btn-cancel { background: #e0e0e0; color: #333; }\n  .ggu-btn-cancel:hover:not(:disabled) { background: #ccc; }\n  .ggu-btn-new { background: #375623; color: #fff; }\n  .ggu-btn-new:hover { background: #264018; }\n  .ggu-btn-export { background: #1B6584; color: #fff; }\n  .ggu-btn-export:hover:not(:disabled) { background: #134d63; }\n  .ggu-table-wrap { flex: 1; overflow-y: auto; border: 1px solid #c5d9f1; border-radius: 6px; min-height: 0; }\n  .ggu-table { width: 100%; border-collapse: collapse; font-size: 12px; }\n  .ggu-table th { background: #1F4E79; color: #fff; padding: 7px 8px; text-align: left; position: sticky; top: 0; z-index: 1; white-space: nowrap; }\n  .ggu-table td { padding: 6px 8px; border-bottom: 1px solid #e0eaf4; vertical-align: middle; }\n  .ggu-table tbody tr:nth-child(odd) td { background: #f5f9ff; }\n  .ggu-table tbody tr:nth-child(even) td { background: #ffffff; }\n  .ggu-table tr:hover td { background: #ddeeff; }\n  .ggu-table tr.ggu-sel td { background: #d0e4f7; }\n  .ggu-act { cursor: pointer; font-size: 11px; padding: 2px 8px; border-radius: 3px; border: none; margin-right: 4px; font-weight: bold; }\n  .ggu-act-edit { background: #1B6584; color: #fff; }\n  .ggu-act-del { background: #c00; color: #fff; }\n  .ggu-msg { padding: 7px 12px; border-radius: 4px; font-size: 12px; font-weight: bold; }\n  .ggu-msg-ok { background: #e2efda; color: #375623; border: 1px solid #b8d4b0; }\n  .ggu-msg-err { background: #fce4e4; color: #c00; border: 1px solid #f5b8b8; }\n  .ggu-gruppo { font-family: monospace; font-size: 11px; background: #e2efda; padding: 2px 6px; border-radius: 3px; color: #375623; white-space: nowrap; }\n  .ggu-empty { text-align: center; color: #888; padding: 20px; font-style: italic; }\n";function w(l){var t,n,i,u;const[s,d]=(0,r.useState)([]),[c,R]=(0,r.useState)(y()),[w,S]=(0,r.useState)(!1),[T,A]=(0,r.useState)(!1),[D,k]=(0,r.useState)(!1),[E,C]=(0,r.useState)(null);(0,r.useEffect)(()=>{O()},[]);const O=()=>a(this,void 0,void 0,function*(){var e;A(!0);try{d(yield function(){return a(this,void 0,void 0,function*(){var e;const l=yield G();return(null!==(e=(yield l.queryFeatures({where:"1=1",outFields:["OBJECTID","username","full_name","ruolo","area","settore","ufficio","gruppo","gruppo_precedente"],returnGeometry:!1})).features)&&void 0!==e?e:[]).map(e=>{var l,r,a,o;const t=e.attributes;return{objectid:null!==(l=t.OBJECTID)&&void 0!==l?l:t.objectid,username:null!==(r=t.username)&&void 0!==r?r:"",full_name:null!==(a=t.full_name)&&void 0!==a?a:"",ruolo:null!=t.ruolo?Number(t.ruolo):null,area:null!=t.area?Number(t.area):null,settore:null!=t.settore?Number(t.settore):null,ufficio:null!=t.ufficio?Number(t.ufficio):null,gruppo:null!==(o=t.gruppo)&&void 0!==o?o:""}})})}())}catch(l){F("Errore caricamento: "+(null!==(e=null==l?void 0:l.message)&&void 0!==e?e:l),!1)}A(!1)}),F=(e,l)=>{C({text:e,ok:l}),setTimeout(()=>C(null),4e3)},M=e=>a(this,void 0,void 0,function*(){var r,o,t;if(window.confirm(`Eliminare l'utente "${e.username}"?`)){k(!0);try{const t=yield g(null!==(o=null===(r=l.config)||void 0===r?void 0:r.clientSecret)&&void 0!==o?o:"");e.gruppo&&(yield b(e.username,e.gruppo,t)),yield function(e){return a(this,void 0,void 0,function*(){var l,r,a;const o=yield G(),t=null===(l=(yield o.queryFeatures({objectIds:[e],outFields:["OBJECTID"],returnGeometry:!1})).features)||void 0===l?void 0:l[0];if(!t)throw new Error("Feature non trovata");const n=yield o.applyEdits({deleteFeatures:[t]});if(null===(a=null===(r=n.deleteFeatureResults)||void 0===r?void 0:r[0])||void 0===a?void 0:a.error)throw new Error(n.deleteFeatureResults[0].error.description)})}(e.objectid),F("Utente eliminato",!0),yield O()}catch(e){F("Errore: "+(null!==(t=null==e?void 0:e.message)&&void 0!==t?t:e),!1)}k(!1)}}),U=c.ruolo?v.filter(e=>x(c.ruolo).includes(e.value)):[],z=c.ruolo&&c.area?m.filter(e=>_(c.ruolo,c.area).includes(e.value)):[],P=c.area&&c.settore?j(c.area,c.settore):[],$=1===U.length,Z=!!c.ruolo&&(5===c.ruolo||6===c.ruolo||4===c.ruolo||2===c.ruolo&&1===c.area),L=!!c.ruolo&&(4===c.ruolo||5===c.ruolo||6===c.ruolo||2===c.ruolo&&1===c.area),B=(e,l)=>{var r,a;return null!=l&&null!==(a=null===(r=e.find(e=>e.value===l))||void 0===r?void 0:r.label)&&void 0!==a?a:""};return(0,e.jsxs)(o,{children:[(0,e.jsx)("style",{children:N}),(0,e.jsxs)("div",{className:"ggu",children:[(0,e.jsx)("div",{className:"ggu-title",children:"GII \u2013 Gestione Utenti"}),E&&(0,e.jsx)("div",{className:"ggu-msg "+(E.ok?"ggu-msg-ok":"ggu-msg-err"),children:E.text}),!w&&(0,e.jsxs)("div",{style:{display:"flex",gap:8},children:[(0,e.jsx)("button",{className:"ggu-btn ggu-btn-new",onClick:()=>{R(y()),S(!0)},children:"+ Nuovo utente"}),(0,e.jsx)("button",{className:"ggu-btn ggu-btn-export",onClick:()=>function(e){const l=(e,l)=>{var r,a;return null!=l&&null!==(a=null===(r=e.find(e=>e.value===l))||void 0===r?void 0:r.label)&&void 0!==a?a:""},r=["username,full_name,area_cod,settore_cod,ufficio,ruolo,id_ufficio,gruppo",...e.map(e=>{var r,a;const o=l(v,e.area),t=l(m,e.settore),n=l(h,e.ufficio),i=l(p,e.ruolo),u=null!==(r=e.ufficio)&&void 0!==r?r:"",s=null!==(a=e.gruppo)&&void 0!==a?a:"";return[e.username,e.full_name,o,t,n,i,u,s].map(e=>{const l=String(null!=e?e:"");return l.includes(",")||l.includes('"')||l.includes("\n")?`"${l.replace(/"/g,'""')}"`:l}).join(",")})].join("\n"),a=new Blob([r],{type:"text/csv;charset=utf-8;"}),o=URL.createObjectURL(a),t=document.createElement("a");t.href=o,t.download="utenti.csv",t.click(),URL.revokeObjectURL(o)}(s),disabled:0===s.length,children:"\u2b07 Esporta utenti.csv"})]}),w&&(0,e.jsxs)("div",{className:"ggu-form",children:[(0,e.jsxs)("div",{className:"ggu-field",children:[(0,e.jsx)("div",{className:"ggu-label",children:"Username *"}),(0,e.jsx)("input",{className:"ggu-input",value:c.username,onChange:e=>R(l=>Object.assign(Object.assign({},l),{username:e.target.value}))})]}),(0,e.jsxs)("div",{className:"ggu-field",children:[(0,e.jsx)("div",{className:"ggu-label",children:"Nome completo *"}),(0,e.jsx)("input",{className:"ggu-input",value:c.full_name,onChange:e=>R(l=>Object.assign(Object.assign({},l),{full_name:e.target.value}))})]}),(0,e.jsxs)("div",{className:"ggu-field",children:[(0,e.jsx)("div",{className:"ggu-label",children:"Ruolo *"}),(0,e.jsxs)("select",{className:"ggu-select",value:null!==(t=c.ruolo)&&void 0!==t?t:"",onChange:e=>(e=>{const l=e?x(e):[],r=1===l.length?l[0]:null,a=e&&r?_(e,r):[],o=1===a.length?a[0]:null,t=e&&(4===e||5===e||6===e||2===e&&1===r)?1:null,n=e&&r?I(e,r,null!=o?o:0):"";R(l=>Object.assign(Object.assign({},l),{ruolo:e,area:r,settore:o,ufficio:t,gruppo:n}))})(e.target.value?Number(e.target.value):null),children:[(0,e.jsx)("option",{value:"",children:"\u2014 seleziona \u2014"}),p.map(l=>(0,e.jsx)("option",{value:l.value,children:l.label},l.value))]})]}),(0,e.jsxs)("div",{className:"ggu-field",children:[(0,e.jsx)("div",{className:"ggu-label",children:"Area *"}),(0,e.jsxs)("select",{className:"ggu-select",value:null!==(n=c.area)&&void 0!==n?n:"",disabled:!c.ruolo||$,onChange:e=>(e=>{if(!c.ruolo)return;const l=e?_(c.ruolo,e):[],r=1===l.length?l[0]:null,a=4===c.ruolo||5===c.ruolo||6===c.ruolo||2===c.ruolo&&1===e?1:null,o=c.ruolo&&e?I(c.ruolo,e,null!=r?r:0):"";R(l=>Object.assign(Object.assign({},l),{area:e,settore:r,ufficio:a,gruppo:o}))})(e.target.value?Number(e.target.value):null),children:[(0,e.jsx)("option",{value:"",children:"\u2014 seleziona \u2014"}),U.map(l=>(0,e.jsx)("option",{value:l.value,children:l.label},l.value))]})]}),(0,e.jsxs)("div",{className:"ggu-field",children:[(0,e.jsx)("div",{className:"ggu-label",children:"Settore"}),Z?(0,e.jsx)("input",{className:"ggu-input",disabled:!0,value:B(m,c.settore)||"\u2014"}):(0,e.jsxs)("select",{className:"ggu-select",value:null!==(i=c.settore)&&void 0!==i?i:"",disabled:!c.area||0===z.length,onChange:e=>(e=>{if(!c.ruolo||!c.area)return;const l=e?j(c.area,e):[],r=1===l.length?l[0].value:null,a=c.ruolo&&c.area&&e?I(c.ruolo,c.area,e):"";R(l=>Object.assign(Object.assign({},l),{settore:e,ufficio:r,gruppo:a}))})(e.target.value?Number(e.target.value):null),children:[(0,e.jsx)("option",{value:"",children:"\u2014 seleziona \u2014"}),z.map(l=>(0,e.jsx)("option",{value:l.value,children:l.label},l.value))]})]}),(0,e.jsxs)("div",{className:"ggu-field",children:[(0,e.jsx)("div",{className:"ggu-label",children:"Ufficio *"}),L?(0,e.jsx)("input",{className:"ggu-input",disabled:!0,value:"Cagliari"}):(0,e.jsxs)("select",{className:"ggu-select",value:null!==(u=c.ufficio)&&void 0!==u?u:"",disabled:!c.settore||0===P.length,onChange:e=>{return l=e.target.value?Number(e.target.value):null,void R(e=>Object.assign(Object.assign({},e),{ufficio:l}));var l},children:[(0,e.jsx)("option",{value:"",children:"\u2014 seleziona \u2014"}),P.map(l=>(0,e.jsx)("option",{value:l.value,children:l.label},l.value))]})]}),(0,e.jsxs)("div",{className:"ggu-field",children:[(0,e.jsx)("div",{className:"ggu-label",children:"Gruppo"}),(0,e.jsx)("input",{className:"ggu-input",disabled:!0,value:c.gruppo})]}),(0,e.jsxs)("div",{className:"ggu-btns",children:[(0,e.jsx)("button",{className:"ggu-btn ggu-btn-save",onClick:()=>a(this,void 0,void 0,function*(){var e,r,o;if(!c.username.trim())return void F("Username obbligatorio",!1);if(!c.full_name.trim())return void F("Nome completo obbligatorio",!1);if(!c.ruolo)return void F("Ruolo obbligatorio",!1);if(!c.area)return void F("Area obbligatoria",!1);if(_(c.ruolo,c.area).length>0&&!c.settore)F("Settore obbligatorio",!1);else if(c.ufficio){k(!0);try{const o=yield g(null!==(r=null===(e=l.config)||void 0===e?void 0:e.clientSecret)&&void 0!==r?r:""),t=null!=c.objectid;t&&c.gruppo_precedente&&c.gruppo_precedente!==c.gruppo?(yield b(c.username,c.gruppo_precedente,o),yield f(c.username,c.gruppo,o)):t||(yield f(c.username,c.gruppo,o)),yield function(e){return a(this,void 0,void 0,function*(){var l,r,a,o;const t=yield G(),n={username:e.username,full_name:e.full_name,ruolo:e.ruolo,area:e.area,settore:e.settore,ufficio:e.ufficio,gruppo:e.gruppo||null,gruppo_precedente:e.gruppo_precedente||null};if(null!=e.objectid){n.OBJECTID=e.objectid;const a=yield t.applyEdits({updateFeatures:[{attributes:n}]});if(null===(r=null===(l=a.updateFeatureResults)||void 0===l?void 0:l[0])||void 0===r?void 0:r.error)throw new Error(a.updateFeatureResults[0].error.description)}else{const e=yield t.applyEdits({addFeatures:[{attributes:n}]});if(null===(o=null===(a=e.addFeatureResults)||void 0===a?void 0:a[0])||void 0===o?void 0:o.error)throw new Error(e.addFeatureResults[0].error.description)}})}(c),F(c.objectid?"Utente aggiornato":"Utente aggiunto",!0),S(!1),R(y()),yield O()}catch(e){F("Errore: "+(null!==(o=null==e?void 0:e.message)&&void 0!==o?o:e),!1)}k(!1)}else F("Ufficio obbligatorio",!1)}),disabled:D,children:D?"Salvataggio...":c.objectid?"Aggiorna":"Salva"}),(0,e.jsx)("button",{className:"ggu-btn ggu-btn-cancel",onClick:()=>{R(y()),S(!1)},disabled:D,children:"Annulla"})]})]}),(0,e.jsx)("div",{className:"ggu-table-wrap",children:T?(0,e.jsx)("div",{className:"ggu-empty",children:"Caricamento..."}):(0,e.jsxs)("table",{className:"ggu-table",children:[(0,e.jsx)("thead",{children:(0,e.jsxs)("tr",{children:[(0,e.jsx)("th",{children:"Username"}),(0,e.jsx)("th",{children:"Nome"}),(0,e.jsx)("th",{children:"Ruolo"}),(0,e.jsx)("th",{children:"Area"}),(0,e.jsx)("th",{children:"Settore"}),(0,e.jsx)("th",{children:"Ufficio"}),(0,e.jsx)("th",{children:"Gruppo"}),(0,e.jsx)("th",{})]})}),(0,e.jsxs)("tbody",{children:[0===s.length&&(0,e.jsx)("tr",{children:(0,e.jsx)("td",{colSpan:8,className:"ggu-empty",children:"Nessun utente presente"})}),s.map(l=>(0,e.jsxs)("tr",{className:c.objectid===l.objectid?"ggu-sel":"",children:[(0,e.jsx)("td",{children:l.username}),(0,e.jsx)("td",{children:l.full_name}),(0,e.jsx)("td",{children:B(p,l.ruolo)}),(0,e.jsx)("td",{children:B(v,l.area)}),(0,e.jsx)("td",{children:B(m,l.settore)}),(0,e.jsx)("td",{children:B(h,l.ufficio)}),(0,e.jsx)("td",{children:(0,e.jsx)("span",{className:"ggu-gruppo",children:l.gruppo})}),(0,e.jsxs)("td",{children:[(0,e.jsx)("button",{className:"ggu-act ggu-act-edit",onClick:()=>(e=>{R({objectid:e.objectid,username:e.username,full_name:e.full_name,ruolo:e.ruolo,area:e.area,settore:e.settore,ufficio:e.ufficio,gruppo:e.gruppo,gruppo_precedente:e.gruppo}),S(!0)})(l),children:"\u270e"}),(0,e.jsx)("button",{className:"ggu-act ggu-act-del",onClick:()=>M(l),children:"\u2715"})]})]},l.objectid))]})]})})]})]})}function S(e){t.p=e}})(),n})())}}});