System.register(["jimu-core/emotion","jimu-core","jimu-ui/advanced/data-source-selector","jimu-ui/advanced/setting-components","jimu-ui"],function(e,t){var i={},a={},n={},o={},l={};return{setters:[function(e){i.jsx=e.jsx,i.jsxs=e.jsxs},function(e){a.DataSourceManager=e.DataSourceManager,a.DataSourceTypes=e.DataSourceTypes,a.Immutable=e.Immutable,a.React=e.React},function(e){n.DataSourceSelector=e.DataSourceSelector},function(e){o.SettingSection=e.SettingSection},function(e){l.NumericInput=e.NumericInput,l.Switch=e.Switch,l.TextInput=e.TextInput}],execute:function(){e((()=>{var e={89:e=>{"use strict";e.exports=n},244:e=>{"use strict";e.exports=a},298:e=>{"use strict";e.exports=o},321:e=>{"use strict";e.exports=l},386:e=>{"use strict";e.exports=i}},t={};function r(i){var a=t[i];if(void 0!==a)return a.exports;var n=t[i]={exports:{}};return e[i](n,n.exports,r),n.exports}r.d=(e,t)=>{for(var i in t)r.o(t,i)&&!r.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.p="";var s={};return r.p=window.jimuConfig.baseUrl,(()=>{"use strict";r.r(s),r.d(s,{__set_webpack_public_path__:()=>I,default:()=>w});var e=r(386),t=r(244),i=r(89),a=r(298),n=r(321);const o={roleCode:"DT",buttonText:"Prendi in carico",takeColor:"#0078da",integrazioneColor:"#e75a05",approvaColor:"#328c54",respingiColor:"#d13438",trasmettiColor:"#6f42c1",panelBg:"#ffffff",panelBorderColor:"#e5e7eb",panelBorderWidth:1,panelBorderRadius:10,panelPadding:12,maskBg:"#ffffff",maskBorderColor:"#e5e7eb",maskBorderWidth:1,maskBorderRadius:10,maskInnerPadding:12,maskOuterOffset:12,dividerColor:"#e5e7eb",titleFontSize:14,statusFontSize:13,msgFontSize:15,detailTitlePrefix:"Dettaglio rapporto n.",detailTitleHeight:28,detailTitlePaddingBottom:10,detailTitlePaddingLeft:0,detailTitleFontSize:14,detailTitleFontWeight:600,detailTitleColor:"rgba(0,0,0,0.85)",rejectReasons:["Mancanza requisiti","Documentazione incompleta","Dati incoerenti","Richiesta non ammissibile","Altro"],reasonsZebraOddBg:"#ffffff",reasonsZebraEvenBg:"#f6f7f9",reasonsRowBorderColor:"rgba(0,0,0,0.10)",reasonsRowBorderWidth:1,reasonsRowRadius:8,tabs:[{id:"anagrafica",label:"Anagrafica",fields:[],hideEmpty:!1},{id:"violazione",label:"Violazione",fields:[],hideEmpty:!0},{id:"iter",label:"Iter",fields:[],isIterTab:!0,hideEmpty:!1},{id:"allegati",label:"Allegati",fields:[],hideEmpty:!0},{id:"azioni",label:"Azioni",fields:[],locked:!0}],showEditButtons:!0,editOverlayColor:"#7c3aed",editPageColor:"#5b21b6",editPageId:"editing-ti",fieldStatoTI:"stato_TI",fieldPresaTI:"presa_in_carico_TI",editMinStato:2,editMaxStato:2,editPresaRequiredVal:2,presets:[],activePresetId:""};(0,t.Immutable)(o);var l=function(e,t,i,a){return new(i||(i=Promise))(function(n,o){function l(e){try{s(a.next(e))}catch(e){o(e)}}function r(e){try{s(a.throw(e))}catch(e){o(e)}}function s(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(l,r)}s((a=a.apply(e,t||[])).next())})},d=function(e,t){var i={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(i[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(a=Object.getOwnPropertySymbols(e);n<a.length;n++)t.indexOf(a[n])<0&&Object.prototype.propertyIsEnumerable.call(e,a[n])&&(i[a[n]]=e[a[n]])}return i};const c=["#000000","#ffffff","#0078da","#328c54","#e75a05","#d13438","#6f42c1","#f2f2f2","#e5e7eb","#f6f7f9","#eaf2ff"],u=e=>/^#([0-9a-f]{3}|[0-9a-f]{6}|[0-9a-f]{8})$/i.test((e||"").trim()),p={width:"100%",padding:"6px 8px",borderRadius:8,border:"1px solid rgba(0,0,0,0.2)"},g={padding:"6px 10px",borderRadius:10,border:"1px solid rgba(0,0,0,0.2)",background:"#f6f7f9",cursor:"pointer",fontSize:12,fontWeight:700,color:"#111"},b={fontWeight:700,marginBottom:6,whiteSpace:"normal",wordBreak:"keep-all",overflowWrap:"normal"},f={fontSize:12,opacity:.75,marginBottom:8,whiteSpace:"normal",wordBreak:"keep-all",overflowWrap:"normal"};function x(e){let t=[];return t=Array.isArray(e.tabs)&&e.tabs.length>0?e.tabs:[{id:"anagrafica",label:"Anagrafica",fields:Array.isArray(e.anagraficaFields)?e.anagraficaFields:[]},{id:"violazione",label:"Violazione",fields:Array.isArray(e.violazioneFields)?e.violazioneFields:[]},{id:"iter",label:"Iter",fields:Array.isArray(e.iterExtraFields)?e.iterExtraFields:[],isIterTab:!0},{id:"allegati",label:"Allegati",fields:Array.isArray(e.allegatiFields)?e.allegatiFields:[]},{id:"azioni",label:"Azioni",fields:[]}],t.map(e=>{if("azioni"===e.id){const{locked:t}=e;return d(e,["locked"])}return e}).map(e=>{var t;return Object.assign(Object.assign({},e),{hideEmpty:null!==(t=e.hideEmpty)&&void 0!==t?t:"violazione"===e.id})})}function h(e){return(null==e?void 0:e.asMutable)?e.asMutable({deep:!0}):e}function m(e,t){const i=Number(e);return Number.isFinite(i)?i:t}function v(t){return(0,e.jsxs)("div",{style:{width:"100%",marginBottom:12},children:[(0,e.jsx)("div",{style:b,children:t.label}),t.help&&(0,e.jsx)("div",{style:f,children:t.help}),t.children]})}function y(i){const[a,n]=t.React.useState(null),[o,l]=t.React.useState(null),r=Array.isArray(i.tabs)?i.tabs:[],s=e=>{null!==a&&a!==e&&((e,t)=>{if(e===t)return;const a=[...r],[n]=a.splice(e,1);a.splice(t,0,n),i.onChange(a)})(a,e),n(null),l(null)},d=()=>{n(null),l(null)},c={display:"flex",alignItems:"center",gap:6,padding:"5px 8px",borderRadius:6,border:"1px solid rgba(0,0,0,0.12)",background:"#fff",marginBottom:6},u=Object.assign(Object.assign({},c),{borderColor:"#0078da",background:"#eaf2ff"}),p={cursor:"grab",fontSize:16,color:"rgba(0,0,0,0.5)",userSelect:"none",padding:"0 3px"},g={flex:1,padding:"4px 7px",borderRadius:5,border:"1px solid rgba(0,0,0,0.2)",fontSize:12},b={padding:"4px 8px",borderRadius:5,border:"1px solid rgba(0,0,0,0.2)",background:"#f6f7f9",cursor:"pointer",fontSize:11,fontWeight:700},f=Object.assign(Object.assign({},b),{background:"#fee",color:"#d13438"});return(0,e.jsxs)("div",{style:{width:"100%"},children:[(0,e.jsx)("div",{style:{marginBottom:8},children:r.map((t,b)=>{const x=a===b,h=o===b?u:c;return(0,e.jsxs)("div",{draggable:!t.locked,onDragStart:()=>(e=>{n(e)})(b),onDragOver:e=>((e,t)=>{e.preventDefault(),l(t)})(e,b),onDrop:()=>s(b),onDragEnd:d,style:Object.assign(Object.assign({},h),{opacity:x?.5:1}),children:[!t.locked&&(0,e.jsx)("span",{style:p,title:"Trascina per riordinare",children:"\u2630"}),(0,e.jsx)("input",{type:"text",style:g,value:t.label,onChange:e=>((e,t)=>{const a=r.map((i,a)=>a===e?Object.assign(Object.assign({},i),t):i);i.onChange(a)})(b,{label:e.target.value}),placeholder:"Nome tab",disabled:t.locked&&"azioni"===t.id}),t.locked&&(0,e.jsx)("span",{style:{fontSize:10,opacity:.6,whiteSpace:"nowrap"},children:"[Bloccata]"}),!t.locked&&(0,e.jsx)("button",{type:"button",style:f,onClick:()=>(e=>{const t=r[e];if(null==t?void 0:t.locked)return;const a=r.filter((t,i)=>i!==e);i.onChange(a)})(b),title:"Rimuovi tab",children:"\u2715"})]},t.id)})}),(0,e.jsx)("button",{type:"button",style:Object.assign(Object.assign({},b),{width:"100%",background:"#eaf2ff",color:"#0078da",borderColor:"#0078da"}),onClick:()=>{const e={id:`tab_${Date.now()}`,label:"Nuova Tab",fields:[]};i.onChange([...r,e])},children:"+ Aggiungi Tab"})]})}function j(t){const i=t.value||"",a=u(i)?i:"#000000";return(0,e.jsxs)(v,{label:t.label,children:[(0,e.jsxs)("div",{style:{display:"flex",gap:10,alignItems:"center",width:"100%"},children:[(0,e.jsx)("input",{type:"text",style:Object.assign(Object.assign({},p),{flex:1}),value:i,onChange:e=>t.onChange(e.target.value),placeholder:"#rrggbb"}),(0,e.jsx)("input",{type:"color",value:a,onChange:e=>t.onChange(e.target.value),title:"Scegli colore",style:{width:44,height:34,padding:0,border:"1px solid rgba(0,0,0,0.2)",borderRadius:10}})]}),(0,e.jsx)("div",{style:{display:"flex",flexWrap:"wrap",gap:6,marginTop:8},children:c.map(i=>(0,e.jsx)("button",{type:"button",onClick:()=>t.onChange(i),title:i,style:{width:22,height:22,borderRadius:7,border:"1px solid rgba(0,0,0,0.18)",background:i,cursor:"pointer"}},i))})]})}function S(t){var i;return(0,e.jsx)(v,{label:t.label,children:(0,e.jsx)("input",{type:"number",style:p,value:Number.isFinite(t.value)?t.value:0,min:t.min,max:t.max,step:null!==(i=t.step)&&void 0!==i?i:1,onChange:e=>t.onChange(m(e.target.value,t.value))})})}function C(t){return(0,e.jsx)(v,{label:t.label,children:(0,e.jsx)("input",{type:"text",style:p,value:t.value,onChange:e=>t.onChange(e.target.value)})})}function z(i){const{tab:a,allFields:n,onTabPatch:o}=i,l=a.label,r=a.isIterTab?'In "Iter" i blocchi DT/DA sono sempre visibili. Qui aggiungi campi extra sotto i blocchi.':void 0,[s,d]=t.React.useState(""),[c,u]=t.React.useState(!1),[b,f]=t.React.useState(null),[x,h]=t.React.useState(null),m=t.React.useRef(null),v=Array.isArray(a.fields)?a.fields:[],y=t.React.useMemo(()=>new Set(v),[v]);t.React.useEffect(()=>{if(!c)return;const e=e=>{const t=m.current,i=e.target;t&&(t.contains(i)||u(!1))};return document.addEventListener("mousedown",e,!0),()=>document.removeEventListener("mousedown",e,!0)},[c]);const j=t.React.useMemo(()=>{const e=(s||"").trim().toLowerCase(),t=Array.isArray(n)?n:[];return e?t.filter(t=>(t.alias||"").toLowerCase().includes(e)||(t.name||"").toLowerCase().includes(e)):t},[s,n]),S=e=>{const t=j.map(e=>e.name).filter(Boolean);if(t.length)if("add"===e){const e=Array.from(new Set([...v,...t]));i.onChange(e)}else{const e=new Set(t),a=v.filter(t=>!e.has(t));i.onChange(a)}},C=t.React.useMemo(()=>{const e=new Map;return(Array.isArray(n)?n:[]).forEach(t=>e.set(t.name,t)),v.map(t=>e.get(t)||{name:t,alias:t})},[v,n]),z=(()=>{if(!C.length)return"Seleziona...";const e=C[0],t=(e.alias||e.name||"").trim();return 1===C.length?t:`${t} +${C.length-1}`})();return(0,e.jsxs)("div",{ref:m,style:{position:"relative",width:"100%"},children:[(0,e.jsxs)("div",{style:{width:"100%",display:"flex",alignItems:"center",gap:10,padding:"8px 10px",border:"1px solid rgba(255,255,255,0.18)",borderRadius:10,background:"rgba(255,255,255,0.06)",color:"#fff",cursor:"pointer",boxSizing:"border-box",userSelect:"none"},role:"button",tabIndex:0,onClick:()=>u(e=>!e),onKeyDown:e=>{"Enter"!==e.key&&" "!==e.key||u(e=>!e)},title:"Seleziona campi",children:[(0,e.jsxs)("div",{style:{display:"inline-flex",alignItems:"center",padding:"2px 10px",borderRadius:999,background:"#ffffff",color:"#111",fontSize:12,fontWeight:800},children:[v.length," selezionati"]}),(0,e.jsx)("div",{style:{flex:1,minWidth:0,fontSize:12,opacity:.95,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:z}),(0,e.jsx)("div",{style:{fontWeight:900,opacity:.9},children:c?"\u25b2":"\u25bc"})]}),c&&(0,e.jsxs)("div",{style:{position:"absolute",zIndex:1e3,top:"calc(100% + 8px)",left:0,right:0,borderRadius:12,border:"1px solid rgba(0,0,0,0.15)",background:"#fff",boxShadow:"0 10px 30px rgba(0,0,0,0.25)",padding:10,boxSizing:"border-box"},children:[(0,e.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",gap:10,marginBottom:8},children:[(0,e.jsxs)("div",{style:{fontWeight:900,fontSize:13,color:"#111"},children:[l," \u2014 selezione campi"]}),(0,e.jsx)("button",{type:"button",onClick:()=>u(!1),style:{border:"1px solid rgba(0,0,0,0.2)",borderRadius:10,padding:"6px 10px",background:"#fff",cursor:"pointer"},children:"Chiudi"})]}),r&&(0,e.jsx)("div",{style:{fontSize:12,color:"#111",opacity:.75,marginBottom:10},children:r}),(0,e.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:8,marginBottom:12},children:[(0,e.jsx)("input",{type:"checkbox",checked:!!a.hideEmpty,onChange:e=>o({hideEmpty:e.target.checked})}),(0,e.jsx)("span",{style:{fontSize:12,fontWeight:800,color:"#111"},children:"Nascondi campi vuoti (solo questa tab)"})]}),(0,e.jsxs)("div",{style:{marginBottom:12},children:[(0,e.jsx)("div",{style:{fontSize:12,fontWeight:900,marginBottom:6,color:"#111"},children:"Selezionati (ordine)"}),(0,e.jsx)("div",{style:{border:"1px solid rgba(0,0,0,0.12)",borderRadius:10,overflow:"hidden",background:"#fff"},children:(0,e.jsxs)("div",{style:{maxHeight:200,overflowY:"auto"},children:[C.map((t,a)=>{const n=(t.alias||t.name||"").trim(),o=t.name,l=a%2==0?"#ffffff":"#fbfbfb",r=x===a;return(0,e.jsxs)("div",{title:`${n} (${o}) - trascina per riordinare`,draggable:!0,onDragStart:()=>f(a),onDragEnter:()=>h(a),onDragOver:e=>{e.preventDefault()},onDrop:e=>{e.preventDefault();null!==b&&((e,t)=>{if(e===t)return;const a=[...v],[n]=a.splice(e,1);a.splice(t,0,n),i.onChange(a)})(b,a),f(null),h(null)},onDragEnd:()=>{f(null),h(null)},style:{display:"flex",gap:8,alignItems:"center",padding:"7px 10px",borderBottom:"1px solid rgba(0,0,0,0.06)",background:l,color:"#111",outline:r?"2px dashed rgba(47,111,237,0.9)":"none",outlineOffset:-2,cursor:"grab"},children:[(0,e.jsx)("div",{style:{width:22,textAlign:"center",fontWeight:900,opacity:.85,userSelect:"none",cursor:"grab",fontSize:16,lineHeight:"16px"},children:"\u2261"}),(0,e.jsx)("div",{style:{flex:1,minWidth:0},children:(0,e.jsx)("div",{style:{fontWeight:900,fontSize:12,color:"#111",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:n})}),(0,e.jsx)("button",{type:"button",onClick:()=>(e=>{const t=v.filter(t=>t!==e);i.onChange(t)})(o),title:"Rimuovi",style:{border:"1px solid rgba(0,0,0,0.15)",borderRadius:8,padding:"4px 8px",cursor:"pointer",background:"#fff",color:"#111"},children:"\u2715"})]},o)}),!C.length&&(0,e.jsx)("div",{style:{padding:10,fontSize:12,opacity:.75,color:"#111"},children:"Nessun campo selezionato."})]})}),(0,e.jsx)("div",{style:{marginTop:8,fontSize:11,opacity:.75,color:"#111"},children:"Suggerimento: trascina i campi per cambiare l\u2019ordine."})]}),(0,e.jsxs)("div",{children:[(0,e.jsx)("div",{style:{fontSize:12,fontWeight:900,marginBottom:6,color:"#111"},children:"Tutti i campi"}),(0,e.jsx)("input",{type:"text",value:s,onChange:e=>d(e.target.value),style:Object.assign(Object.assign({},p),{marginBottom:8,color:"#111",background:"#fff"}),placeholder:"Cerca per alias o nome..."}),(0,e.jsxs)("div",{style:{display:"flex",gap:8,marginBottom:8},children:[(0,e.jsx)("button",{type:"button",onClick:()=>S("add"),style:Object.assign({},g),title:"Seleziona tutti i campi filtrati (in base alla ricerca)",children:"Seleziona tutti"}),(0,e.jsx)("button",{type:"button",onClick:()=>S("remove"),style:Object.assign({},g),title:"Deseleziona tutti i campi filtrati (in base alla ricerca)",children:"Deseleziona tutti"})]}),(0,e.jsx)("div",{style:{border:"1px solid rgba(0,0,0,0.12)",borderRadius:10,overflow:"hidden",background:"#fff"},children:(0,e.jsxs)("div",{style:{maxHeight:260,overflowY:"auto"},children:[j.map((t,a)=>{const n=y.has(t.name),o=a%2==0?"#ffffff":"#fbfbfb",l=(t.alias||t.name||"").trim(),r=t.name;return(0,e.jsxs)("label",{title:r,style:{display:"flex",gap:8,alignItems:"center",padding:"7px 10px",borderBottom:"1px solid rgba(0,0,0,0.06)",background:o,cursor:"pointer",color:"#111"},children:[(0,e.jsx)("input",{type:"checkbox",checked:n,onChange:()=>(e=>{if(!e)return;const t=y.has(e)?v.filter(t=>t!==e):[...v,e];i.onChange(t)})(r)}),(0,e.jsx)("div",{style:{display:"grid"},children:(0,e.jsx)("div",{style:{fontWeight:800,fontSize:12,color:"#111"},children:l})})]},r)}),!j.length&&(0,e.jsx)("div",{style:{padding:10,fontSize:12,opacity:.75,color:"#111"},children:"Nessun campo."})]})})]})]})]})}function T(i){const{presets:a}=i,[n,o]=t.React.useState(""),l=(a||[]).find(e=>String(e.id)===String(i.activePresetId)),r={border:"1px solid rgba(0,0,0,0.18)",background:"#fff",borderRadius:8,padding:"5px 8px",fontSize:11,fontWeight:800,cursor:"pointer",color:"#111",whiteSpace:"nowrap"},s=Object.assign(Object.assign({},r),{opacity:.45,cursor:"not-allowed"});return(0,e.jsxs)("div",{style:{display:"grid",gap:10},children:[(0,e.jsx)("div",{children:(0,e.jsxs)("select",{value:i.activePresetId||"",onChange:e=>i.onSetActive(e.target.value),style:{padding:"6px 10px",borderRadius:10,border:"1px solid rgba(0,0,0,0.18)",fontSize:13,width:"100%",background:"#fff",color:"#111"},title:"Seleziona un preset",children:[(0,e.jsx)("option",{value:"",children:"\u2014 nessun preset \u2014"}),(a||[]).map(t=>(0,e.jsx)("option",{value:t.id,children:t.name},t.id))]})}),(0,e.jsxs)("div",{style:{display:"flex",gap:6,flexWrap:"wrap"},children:[(0,e.jsx)("button",{type:"button",style:l?r:s,disabled:!l,onClick:()=>l&&i.onApply(l),children:"Applica"}),(0,e.jsx)("button",{type:"button",style:l?r:s,disabled:!l,onClick:()=>l&&i.onUpdateActive(l.id),children:"Aggiorna"}),(0,e.jsx)("button",{type:"button",style:l?r:s,disabled:!l,onClick:()=>l&&i.onDelete(l.id),children:"Elimina"})]}),(0,e.jsxs)("div",{style:{display:"grid",gap:6},children:[(0,e.jsx)("input",{type:"text",value:n,onChange:e=>o(e.target.value),placeholder:"Nome nuovo preset (es. DIR, RI...)",style:{padding:"6px 10px",borderRadius:8,border:"1px solid rgba(0,0,0,0.18)",fontSize:12,width:"100%",background:"#fff",color:"#111"}}),(0,e.jsx)("button",{type:"button",style:n.trim()?Object.assign(Object.assign({},r),{width:"100%"}):Object.assign(Object.assign({},s),{width:"100%"}),disabled:!n.trim(),onClick:()=>{const e=n.trim();e&&(i.onSaveNew(e),o(""))},title:"Salva come nuovo preset",children:"Salva come nuovo"})]}),l&&(0,e.jsxs)("div",{style:{fontSize:12,opacity:.75,color:"#111"},children:["Preset attivo: ",(0,e.jsx)("b",{children:l.name})]})]})}function w(r){var s,d,c,u,g,b,f,w,I,k,R,O,D,B,P,A,F;const E=(0,t.Immutable)([t.DataSourceTypes.FeatureLayer]),W=Object.assign(Object.assign({},o),h(r.config)||{}),_=r.config||(0,t.Immutable)(o),M=e=>{let i=_;Object.entries(e).forEach(([e,a])=>{i="rejectReasons"===e||"tabs"===e||"anagraficaFields"===e||"violazioneFields"===e||"allegatiFields"===e||"iterExtraFields"===e||"presets"===e?i.set(e,(0,t.Immutable)(a||[])):i.set(e,a)}),r.onSettingChange({id:r.id,config:i})},N=h(null!==(s=r.useDataSources)&&void 0!==s?s:(0,t.Immutable)([]))||[],L=String((null===(d=null==N?void 0:N[0])||void 0===d?void 0:d.dataSourceId)||""),[V,q]=t.React.useState([]);t.React.useEffect(()=>{let e=!1;return(()=>{l(this,void 0,void 0,function*(){var i;if(L)try{const a=t.DataSourceManager.getInstance().getDataSource(L),n=null===(i=null==a?void 0:a.getSchema)||void 0===i?void 0:i.call(a),o=(null==n?void 0:n.fields)||{},l=Object.keys(o).map(e=>{const t=o[e]||{};return{name:e,alias:String(t.alias||t.label||t.title||e),type:String(t.type||"")}}).sort((e,t)=>(e.alias||e.name).localeCompare(t.alias||t.name,"it",{sensitivity:"base"}));e||q(l)}catch(t){e||q([])}else e||q([])})})(),()=>{e=!0}},[L]);const $=function(e){const t=h(e);return(Array.isArray(t)?t:[]).map(e=>String(e)).filter(Boolean)}(null!==(c=W.rejectReasons)&&void 0!==c?c:o.rejectReasons),H=x(W),U=(e,t)=>{const i=H.map((i,a)=>a===e?Object.assign(Object.assign({},i),t):i);M({tabs:i})};return(0,e.jsxs)("div",{className:"p-3",style:{width:"100%"},children:[(0,e.jsxs)(a.SettingSection,{title:"Dati",children:[(0,e.jsx)(v,{label:"Data source (selezione multipla)",help:"Seleziona una o pi\xf9 Data View / feature layer. Il runtime user\xe0 automaticamente quella \u201cattiva\u201d (quella che ha la selezione corrente).",children:(0,e.jsx)("div",{style:{width:"100%"},children:(0,e.jsx)(i.DataSourceSelector,{widgetId:r.id,types:E,isMultiple:!0,useDataSources:r.useDataSources,useDataSourcesEnabled:r.useDataSourcesEnabled,onToggleUseDataEnabled:e=>{r.onSettingChange({id:r.id,useDataSourcesEnabled:e})},onChange:e=>{r.onSettingChange({id:r.id,useDataSources:e})},mustUseDataSource:!0})})}),(0,e.jsx)(v,{label:"Ruolo",help:"DT = Direttore Tecnico, DA = Direttore Amministrativo.",children:(0,e.jsxs)("select",{style:p,value:(W.roleCode||"DT").toString().toUpperCase(),onChange:e=>M({roleCode:e.target.value}),children:[(0,e.jsx)("option",{value:"DT",children:"DT"}),(0,e.jsx)("option",{value:"DA",children:"DA"})]})}),(0,e.jsx)(v,{label:"Testo bottone \u201cPrendi in carico\u201d",children:(0,e.jsx)("input",{type:"text",style:p,value:null!==(u=W.buttonText)&&void 0!==u?u:"Prendi in carico",onChange:e=>M({buttonText:e.target.value})})})]}),(0,e.jsx)(a.SettingSection,{title:"Gestione Tab",children:(0,e.jsx)(v,{label:"Configurazione Tab",help:"Modifica i nomi, aggiungi/rimuovi tab, e riordina trascinando.",children:(0,e.jsx)(y,{tabs:H,onChange:e=>M({tabs:e})})})}),(0,e.jsxs)(a.SettingSection,{title:"Campi per Tab",children:[(0,e.jsx)(v,{label:"Selezione e ordine campi",help:"Spunta i campi che vuoi visualizzare in ciascuna tab e usa \u2191 \u2193 per l\u2019ordine. Se una tab \xe8 vuota, il runtime usa un fallback \u201cauto\u201d.",children:L?null:(0,e.jsx)("div",{style:{fontSize:12,opacity:.75},children:"Seleziona prima un Data Source."})}),H.map((t,i)=>"azioni"===t.id?null:(0,e.jsx)(z,{tab:t,allFields:V,onChange:e=>((e,t)=>{U(e,{fields:t})})(i,e),onTabPatch:e=>U(i,e)},t.id))]}),(0,e.jsxs)(a.SettingSection,{title:"Titolo pratica",children:[(0,e.jsx)(C,{label:"Testo titolo",value:String(null!==(g=W.detailTitlePrefix)&&void 0!==g?g:o.detailTitlePrefix),onChange:e=>M({detailTitlePrefix:e})}),(0,e.jsx)(S,{label:"Altezza riga (px)",value:m(W.detailTitleHeight,o.detailTitleHeight),min:0,max:60,step:1,onChange:e=>M({detailTitleHeight:e})}),(0,e.jsx)(S,{label:"Spaziatura inferiore (px)",value:m(W.detailTitlePaddingBottom,o.detailTitlePaddingBottom),min:0,max:30,step:1,onChange:e=>M({detailTitlePaddingBottom:e})}),(0,e.jsx)(S,{label:"Padding sinistro (px)",value:m(W.detailTitlePaddingLeft,o.detailTitlePaddingLeft),min:0,max:50,step:1,onChange:e=>M({detailTitlePaddingLeft:e})}),(0,e.jsx)(S,{label:"Dimensione font (px)",value:m(W.detailTitleFontSize,o.detailTitleFontSize),min:10,max:24,step:1,onChange:e=>M({detailTitleFontSize:e})}),(0,e.jsx)(S,{label:"Peso font",value:m(W.detailTitleFontWeight,o.detailTitleFontWeight),min:100,max:900,step:100,onChange:e=>M({detailTitleFontWeight:e})}),(0,e.jsx)(j,{label:"Colore testo",value:String(null!==(b=W.detailTitleColor)&&void 0!==b?b:o.detailTitleColor),onChange:e=>M({detailTitleColor:e})})]}),(0,e.jsxs)(a.SettingSection,{title:"Maschera (bordi e spazi)",children:[(0,e.jsx)(S,{label:"Offset esterno (px)",value:m(W.maskOuterOffset,o.maskOuterOffset),min:0,max:50,step:1,onChange:e=>M({maskOuterOffset:e})}),(0,e.jsx)(S,{label:"Padding interno (px)",value:m(W.maskInnerPadding,o.maskInnerPadding),min:0,max:50,step:1,onChange:e=>M({maskInnerPadding:e,panelPadding:e})}),(0,e.jsx)(j,{label:"Sfondo maschera",value:String(null!==(f=W.maskBg)&&void 0!==f?f:o.maskBg),onChange:e=>M({maskBg:e,panelBg:e})}),(0,e.jsx)(j,{label:"Colore bordo maschera",value:String(null!==(w=W.maskBorderColor)&&void 0!==w?w:o.maskBorderColor),onChange:e=>M({maskBorderColor:e,panelBorderColor:e})}),(0,e.jsx)(S,{label:"Spessore bordo (px)",value:m(W.maskBorderWidth,o.maskBorderWidth),min:0,max:10,step:1,onChange:e=>M({maskBorderWidth:e,panelBorderWidth:e})}),(0,e.jsx)(S,{label:"Raggio bordo (px)",value:m(W.maskBorderRadius,o.maskBorderRadius),min:0,max:30,step:1,onChange:e=>M({maskBorderRadius:e,panelBorderRadius:e})}),(0,e.jsx)(j,{label:"Colore divisori",value:String(null!==(I=W.dividerColor)&&void 0!==I?I:o.dividerColor),onChange:e=>M({dividerColor:e})})]}),(0,e.jsxs)(a.SettingSection,{title:"Testi",children:[(0,e.jsx)(S,{label:"Dimensione titolo (px)",value:m(W.titleFontSize,o.titleFontSize),min:12,max:20,step:1,onChange:e=>M({titleFontSize:e})}),(0,e.jsx)(S,{label:"Dimensione stato (px)",value:m(W.statusFontSize,o.statusFontSize),min:11,max:18,step:1,onChange:e=>M({statusFontSize:e})}),(0,e.jsx)(S,{label:"Dimensione messaggi/avvisi (px)",value:m(W.msgFontSize,o.msgFontSize),min:12,max:20,step:1,onChange:e=>M({msgFontSize:e})})]}),(0,e.jsxs)(a.SettingSection,{title:"Colori pulsanti",children:[(0,e.jsx)(j,{label:"Prendi in carico",value:String(null!==(k=W.takeColor)&&void 0!==k?k:o.takeColor),onChange:e=>M({takeColor:e})}),(0,e.jsx)(j,{label:"Integrazione",value:String(null!==(R=W.integrazioneColor)&&void 0!==R?R:o.integrazioneColor),onChange:e=>M({integrazioneColor:e})}),(0,e.jsx)(j,{label:"Approva",value:String(null!==(O=W.approvaColor)&&void 0!==O?O:o.approvaColor),onChange:e=>M({approvaColor:e})}),(0,e.jsx)(j,{label:"Respingi",value:String(null!==(D=W.respingiColor)&&void 0!==D?D:o.respingiColor),onChange:e=>M({respingiColor:e})}),(0,e.jsx)(j,{label:"Trasmetti a DA",value:String(null!==(B=W.trasmettiColor)&&void 0!==B?B:o.trasmettiColor),onChange:e=>M({trasmettiColor:e})})]}),(0,e.jsxs)(a.SettingSection,{title:"Motivazioni respinta",children:[(0,e.jsxs)(v,{label:"Voci elenco (menu a tendina)",help:"Queste voci popolano il campo \u201cMotivazione\u201d quando fai \u201cRespingi\u201d.",children:[(0,e.jsx)("div",{style:{display:"grid",gap:8},children:$.map((t,i)=>{const a=i%2==0?W.reasonsZebraEvenBg||o.reasonsZebraEvenBg:W.reasonsZebraOddBg||o.reasonsZebraOddBg;return(0,e.jsxs)("div",{style:{display:"flex",gap:8,alignItems:"center",padding:8,background:a,border:`${m(W.reasonsRowBorderWidth,o.reasonsRowBorderWidth)}px solid ${W.reasonsRowBorderColor||o.reasonsRowBorderColor}`,borderRadius:m(W.reasonsRowRadius,o.reasonsRowRadius)},children:[(0,e.jsx)("input",{type:"text",style:Object.assign(Object.assign({},p),{flex:1,margin:0}),value:t,onChange:e=>{const t=e.target.value,a=$.slice();a[i]=t,M({rejectReasons:a})}}),(0,e.jsx)("button",{type:"button",onClick:()=>{const e=$.slice();e.splice(i,1),M({rejectReasons:e})},style:{border:"1px solid rgba(0,0,0,0.2)",borderRadius:8,padding:"6px 10px",cursor:"pointer"},title:"Rimuovi",children:"\u2715"})]},i)})}),(0,e.jsx)("div",{style:{display:"flex",justifyContent:"flex-end",marginTop:10},children:(0,e.jsx)("button",{type:"button",onClick:()=>M({rejectReasons:[...$,""]}),style:{border:"1px solid rgba(0,0,0,0.2)",borderRadius:10,padding:"8px 12px",cursor:"pointer",fontWeight:800},children:"+ Aggiungi voce"})})]}),(0,e.jsx)(v,{label:"Gestione preset",help:"Salva/carica set di campi selezionati per le TAB (utile per ruoli diversi: DIR, RI, ecc.).",children:(0,e.jsx)(T,{presets:W.presets||[],activePresetId:String(W.activePresetId||""),onSetActive:e=>M({activePresetId:e}),onApply:e=>{if(Array.isArray(e.tabs))M({tabs:e.tabs,activePresetId:e.id||""});else{const t=x({anagraficaFields:e.anagraficaFields||[],violazioneFields:e.violazioneFields||[],allegatiFields:e.allegatiFields||[],iterExtraFields:e.iterExtraFields||[]});M({tabs:t,activePresetId:e.id||""})}},onSaveNew:e=>{const t=String(Date.now()),i=[...W.presets||[],{id:t,name:e,tabs:H}];M({presets:i,activePresetId:t})},onUpdateActive:e=>{const t=(W.presets||[]).map(t=>t.id===e?Object.assign(Object.assign({},t),{tabs:H}):t);M({presets:t})},onDelete:e=>{const t=(W.presets||[]).filter(t=>t.id!==e),i=String(W.activePresetId||"")===e?"":String(W.activePresetId||"");M({presets:t,activePresetId:i})}})})]}),(0,e.jsxs)(a.SettingSection,{title:"Editing TI",children:[(0,e.jsx)(v,{label:"Mostra pulsanti Modifica",children:(0,e.jsx)(n.Switch,{checked:!1!==W.showEditButtons,onChange:(e,t)=>M({showEditButtons:t})})}),(0,e.jsx)(v,{label:'Colore pulsante "Modifica (overlay)"',children:(0,e.jsxs)("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[(0,e.jsx)("input",{type:"color",value:W.editOverlayColor||"#7c3aed",onChange:e=>M({editOverlayColor:e.target.value}),style:{width:36,height:28,border:"none",padding:0,cursor:"pointer"}}),(0,e.jsx)(n.TextInput,{value:W.editOverlayColor||"#7c3aed",onChange:e=>M({editOverlayColor:e.target.value}),style:{width:90}})]})}),(0,e.jsx)(v,{label:'Colore pulsante "Modifica (pagina)"',children:(0,e.jsxs)("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[(0,e.jsx)("input",{type:"color",value:W.editPageColor||"#5b21b6",onChange:e=>M({editPageColor:e.target.value}),style:{width:36,height:28,border:"none",padding:0,cursor:"pointer"}}),(0,e.jsx)(n.TextInput,{value:W.editPageColor||"#5b21b6",onChange:e=>M({editPageColor:e.target.value}),style:{width:90}})]})}),(0,e.jsxs)(v,{label:"ID pagina editing (per navigazione)",children:[(0,e.jsx)(n.TextInput,{value:W.editPageId||"editing-ti",onChange:e=>M({editPageId:e.target.value}),placeholder:"editing-ti",style:{width:"100%"}}),(0,e.jsx)("div",{style:{fontSize:11,color:"#9ca3af",marginTop:4},children:"Inserisci l'ID della pagina ExB dedicata all'editing completo (con mappa)."})]}),(0,e.jsx)(v,{label:"Campo presa in carico TI",children:(0,e.jsx)(n.TextInput,{value:W.fieldPresaTI||"presa_in_carico_TI",onChange:e=>M({fieldPresaTI:e.target.value}),placeholder:"presa_in_carico_TI",style:{width:"100%"}})}),(0,e.jsx)(v,{label:"Campo stato TI",children:(0,e.jsx)(n.TextInput,{value:W.fieldStatoTI||"stato_TI",onChange:e=>M({fieldStatoTI:e.target.value}),placeholder:"stato_TI",style:{width:"100%"}})}),(0,e.jsxs)(v,{label:"Valore presa_in_carico_TI richiesto per editing",children:[(0,e.jsx)(n.NumericInput,{value:null!==(P=W.editPresaRequiredVal)&&void 0!==P?P:2,min:0,max:10,step:1,onChange:e=>M({editPresaRequiredVal:Number(e)}),style:{width:70}}),(0,e.jsx)("div",{style:{fontSize:11,color:"#9ca3af",marginTop:4},children:'Default 2 = "Presa in carico". Il TI deve aver preso in carico la pratica.'})]}),(0,e.jsx)(v,{label:"Valore minimo stato_TI per editing",children:(0,e.jsx)(n.NumericInput,{value:null!==(A=W.editMinStato)&&void 0!==A?A:2,min:0,max:10,step:1,onChange:e=>M({editMinStato:Number(e)}),style:{width:70}})}),(0,e.jsxs)(v,{label:"Valore massimo stato_TI per editing",children:[(0,e.jsx)(n.NumericInput,{value:null!==(F=W.editMaxStato)&&void 0!==F?F:2,min:0,max:10,step:1,onChange:e=>M({editMaxStato:Number(e)}),style:{width:70}}),(0,e.jsx)("div",{style:{fontSize:11,color:"#9ca3af",marginTop:4},children:'Il pulsante \xe8 abilitato solo se stato_TI \xe8 compreso tra min e max (inclusi). Es. min=2 max=2 significa "solo quando ancora in lavorazione".'})]})]})]})}function I(e){r.p=e}})(),s})())}}});